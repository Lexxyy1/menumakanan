CREATE DATABASE IF NOT EXISTS user_system;
USE user_system;

-- Tabel User
CREATE TABLE IF NOT EXISTS users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE,
    password VARCHAR(255),
    role ENUM('admin', 'member') DEFAULT 'member',
    status ENUM('active', 'trial', 'expired') DEFAULT 'trial',
    expired_date DATETIME NULL
);

-- Tabel Pengaturan (Nomor Bot)
CREATE TABLE IF NOT EXISTS settings (
    key_name VARCHAR(50) PRIMARY KEY,
    value VARCHAR(255)
);

-- Tabel Riwayat Bug
CREATE TABLE IF NOT EXISTS activity_logs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50),
    target_num VARCHAR(20),
    command_type VARCHAR(50),
    time_executed DATETIME
);

-- Hapus jika ingin reset total, atau gunakan yang sudah ada
CREATE TABLE IF NOT EXISTS users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE,
    password VARCHAR(255),
    role ENUM('admin', 'member') NOT NULL, 
    status ENUM('active', 'trial', 'expired') DEFAULT 'active',
    expired_date DATETIME NULL
);

ALTER TABLE users MODIFY COLUMN role ENUM('admin', 'member') NOT NULL;

-- Data Awal: Username & Pass Admin: admin123
INSERT IGNORE INTO settings (key_name, value) VALUES ('whatsapp_bot', '628xxx');
INSERT IGNORE INTO users (username, password, role, status) VALUES ('admin', 'admin123', 'admin', 'active');